sudo: required
services:
  - docker

addons:
  apt:
    packages:
      - docker-ce

before_install:
 - curl -L https://github.com/docker/compose/releases/download/${COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` > docker-compose
 - chmod +x docker-compose
 - sudo mv docker-compose /usr/local/bin

script:
  - docker-compose up -d --build
  - docker-compose exec golang go test -coverprofile=coverage.txt -cover -v ./

after_success:
  - docker-compose exec golang goveralls -coverprofile=coverage.txt -covermode=count -service=travis-ci -repotoken $COVERALLS_TOKEN

env:
  global:
    - COMPOSE_VERSION: 1.25.4
    - secure: "ZaEYZqIBLUL4yEvjofkYrPXh4U7wqclAvzkCPJI1A+x1M9y0DcfK2CjOe2ZrMN04PSfbxiYbTUQ2y5U0Dlg7O6rMMJE1HbXmsuA/X5hU0e8402aLUCMl/n3+fp/q7Wz5XHmB8BbNqe6Z55roHhLcSWekPDUG5I1pQzyq+zzmMaj/2Ei3C7tUWYHpCTa35su7832luJ1P2nure95ZziVzRYOtXzfUp15y39No52sl0kkeOHniRLUEmWAHh/q/OtuXhuckEkXEQwaKDcSn/aPQj6VOHD+ehbUGQMaf9TzJFxltFZThIghobnqGVmTeoxweCsCsdaCmnVxOxkTC1rsJtdAvWlZCC9KZ50zU82YgLsQSbpUv/0SYMLiScyhEO4RDknrZz0F3o6001Jbh7uFBNNPnXYiKCqFwtUlYbze8lAagZZphYds0F2w2Pzt5wLu+rw8jVAuzRo7CIYuy3UTjH+uuWXbtW3zTH5KxY0+/OuP2tPd+US9R8w0vxoRJZO3zmCf/WullXrPuCHPOh17bej/d2uq0ClOjB3suoR7hR46KyAVGk0KPbKBXcIxUF8Y/x8Ab2An0mU8Xt1CAMtTVlsVH8zVWwouJq5NAR2w79suztTvFjYZz7E5tmN+0+RioDrRem30zy9UwO7JVrSzqaZRSAOZwvlnjySCWtuxUARw="
